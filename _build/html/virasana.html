

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="pt-BR" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="pt-BR" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>VIRASANA &mdash; AJNA 0.1a documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PADMA" href="padma.html" />
    <link rel="prev" title="BHADRASANA" href="bhadrasana.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> AJNA
          

          
          </a>

          
            
            
              <div class="version">
                0.1a
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="manuais.html">Manuais de Usuário</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="codigofonte.html">Documentação do código-fonte</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ajna_commons.html">COMMONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="bhadrasana.html">BHADRASANA</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">VIRASANA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-virasana.virasana.views">Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scripts">Scripts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-virasana.virasana.scripts.cargaupdate">Carga</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-virasana.virasana.scripts.xmlupdate">XML</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-virasana.virasana.scripts.predictionsupdate">Predições (PADMA)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#integracao">Integracao</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-virasana.virasana.integracao">__init__</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Carga</a></li>
<li class="toctree-l4"><a class="reference internal" href="#workers">XML</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Workers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-virasana.virasana.workers.dir_monitor">dir_monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tasks">Tasks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="padma.html">PADMA</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UserStories.html">Histórias de Usuário</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arquitetura.html">Módulos do Sistema</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arquitetura.html#arquitetura-do-sistema">Arquitetura do Sistema</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AJNA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="codigofonte.html">Documentação do código-fonte</a> &raquo;</li>
        
      <li>VIRASANA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/virasana.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="contents topic" id="topicos">
<p class="topic-title first">Tópicos</p>
<ul class="simple">
<li><a class="reference internal" href="#virasana" id="id5">VIRASANA</a><ul>
<li><a class="reference internal" href="#module-virasana.virasana.views" id="id6">Interface</a></li>
<li><a class="reference internal" href="#scripts" id="id7">Scripts</a><ul>
<li><a class="reference internal" href="#module-virasana.virasana.scripts.cargaupdate" id="id8">Carga</a></li>
<li><a class="reference internal" href="#module-virasana.virasana.scripts.xmlupdate" id="id9">XML</a></li>
<li><a class="reference internal" href="#module-virasana.virasana.scripts.predictionsupdate" id="id10">Predições (PADMA)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integracao" id="id11">Integracao</a><ul>
<li><a class="reference internal" href="#module-virasana.virasana.integracao" id="id12">__init__</a></li>
<li><a class="reference internal" href="#id1" id="id13">Carga</a></li>
<li><a class="reference internal" href="#workers" id="id14">XML</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3" id="id15">Workers</a><ul>
<li><a class="reference internal" href="#module-virasana.virasana.workers.dir_monitor" id="id16">dir_monitor</a></li>
<li><a class="reference internal" href="#tasks" id="id17">Tasks</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p><a class="reference external" href="index.html">Voltar ao Indice</a></p>
<div class="section" id="virasana">
<h1><a class="toc-backref" href="#id5">VIRASANA</a><a class="headerlink" href="#virasana" title="Permalink to this headline">¶</a></h1>
<p>Virasana é o módulo que recebe as imagens dos AVATARES, permite gerenciar e consultar as
imagens, e busca completar as imagens com metadados vindos dos módulos BHADRASANA e PADMA</p>
<div class="section" id="module-virasana.virasana.views">
<span id="interface"></span><h2><a class="toc-backref" href="#id6">Interface</a><a class="headerlink" href="#module-virasana.virasana.views" title="Permalink to this headline">¶</a></h2>
<p>Coleção de views da interface web do módulo Virasana.</p>
<p>Módulo Virasana é o Servidor de imagens e a interface para carga,
consulta e integração das imagens com outras bases.</p>
<dl class="class">
<dt id="virasana.virasana.views.FilesForm">
<em class="property">class </em><code class="descclassname">virasana.virasana.views.</code><code class="descname">FilesForm</code><span class="sig-paren">(</span><em>formdata=&lt;object object&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#FilesForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.FilesForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Valida pesquisa de arquivos.</p>
<p>Usa wtforms para facilitar a validação dos campos de pesquisa da tela
search_files.html</p>
</dd></dl>

<dl class="class">
<dt id="virasana.virasana.views.StatsForm">
<em class="property">class </em><code class="descclassname">virasana.virasana.views.</code><code class="descname">StatsForm</code><span class="sig-paren">(</span><em>formdata=&lt;object object&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#StatsForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.StatsForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Valida datas da tela de estatísticas.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.allowed_file">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">allowed_file</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#allowed_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.allowed_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Checa extensões permitidas.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.api_upload">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">api_upload</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#api_upload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.api_upload" title="Permalink to this definition">¶</a></dt>
<dd><p>Função para upload via API de um arquivo BSON.</p>
<p>Coloca o arquivo numa queue do Banco de Dados Redis
e inicia uma task Celery. O resultado do processamento efetivo do
arquivo pode ser acompanhado na view
py:func:<cite>task_progress</cite></p>
<dl class="docutils">
<dt>Args:</dt>
<dd>file: arquivo BSON gerado pelo AJNA e enviado via HTTP POST</dd>
<dt>Returns:</dt>
<dd>json[‘success’]: True ou False
json[‘taskid’]: ID da task do celery a ser monitorada</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.bar_plotly">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">bar_plotly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#bar_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.bar_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Renderiza gráfico no plotly e serializa via HTTP/HTML.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.campos_chave">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">campos_chave</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#campos_chave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.campos_chave" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna campos chave para montagem de filtro.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.configure_app">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">configure_app</code><span class="sig-paren">(</span><em>mongodb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#configure_app"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.configure_app" title="Permalink to this definition">¶</a></dt>
<dd><p>Configurações gerais e de Banco de Dados da Aplicação.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.do_mini">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">do_mini</code><span class="sig-paren">(</span><em>_id</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#do_mini"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.do_mini" title="Permalink to this definition">¶</a></dt>
<dd><p>Recorta a imagem do banco e serializa para stream HTTP.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.file">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">file</code><span class="sig-paren">(</span><em>_id=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.file" title="Permalink to this definition">¶</a></dt>
<dd><p>Tela para exibição de um ‘arquivo’ do GridFS.</p>
<p>Exibe o arquivo e os metadados associados a ele.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.files">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.files" title="Permalink to this definition">¶</a></dt>
<dd><p>Recebe parâmetros, aplica no GridFS, retorna a lista de arquivos.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.filtro">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">filtro</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#filtro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.filtro" title="Permalink to this definition">¶</a></dt>
<dd><p>Configura filtro personalizado.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.grid_data">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">grid_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#grid_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.grid_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Executa uma consulta no banco.</p>
<p>Monta um dicionário de consulta a partir dos argumentos do get.
Se encontrar registro, retorna registro inteiro via JSON (metadados),
o arquivo (campo content) fica em fs.chunks e é recuperado pela view
image_id.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.image">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.image" title="Permalink to this definition">¶</a></dt>
<dd><p>Executa uma consulta no banco.</p>
<p>Monta um dicionário de consulta a partir dos argumentos do get.
Se encontrar registro, chama image_id.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.image_id">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">image_id</code><span class="sig-paren">(</span><em>_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#image_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.image_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Recorta a imagem do banco e serializa para stream HTTP.</p>
<p>Estes métodos dispensam autenticação, pois é necessário ter um _id válido.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.index">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.index" title="Permalink to this definition">¶</a></dt>
<dd><p>View retorna index.html ou login se não autenticado.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.list_files">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">list_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#list_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.list_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Lista arquivos no banco MongoDB.</p>
<p>Lista 10 arquivos mais recentes no banco MongoDB,
por uploadDate mais recente.
Se houver upload em andamento, informa.</p>
</dd></dl>

<dl class="data">
<dt id="virasana.virasana.views.lista_ids">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">lista_ids</code><em class="property"> = []</em><a class="headerlink" href="#virasana.virasana.views.lista_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Para testes de desempenho: o endpoint minitest retorna uma imagem aleatória
Se for passado o parâmetro ‘mini’, faz também recorte
Para habilitar, criar lista_ids descomentando linhas abaixo
lista_ids = [</p>
<blockquote>
<div><p>linha[‘_id’] for linha in
db[‘fs.files’].find(</p>
<blockquote>
<div>{‘metadata.contentType’: ‘image/jpeg’}, {‘_id’: 1}</div></blockquote>
<p>).limit(1000)</p>
</div></blockquote>
<p>]</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.mini">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">mini</code><span class="sig-paren">(</span><em>_id</em>, <em>n=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#mini"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.mini" title="Permalink to this definition">¶</a></dt>
<dd><p>Recorta a imagem do banco e serializa para stream HTTP.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.mini2">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">mini2</code><span class="sig-paren">(</span><em>_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#mini2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.mini2" title="Permalink to this definition">¶</a></dt>
<dd><p>Link para imagem do segundo contêiner, se houver.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.minitest">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">minitest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#minitest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.minitest" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna uma imagem aleatória.</p>
<p>Se for passado o parâmetro ‘mini’, faz também recorte
Deixar desabilitado em produção.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.mynavbar">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">mynavbar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#mynavbar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.mynavbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Menu da aplicação.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.padma_proxy">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">padma_proxy</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#padma_proxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.padma_proxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Teste. Envia uma imagem para padma teste e repassa retorno.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.pie_plotly">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">pie_plotly</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#pie_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.pie_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Renderiza HTML no pyplot e serializa via HTTP/HTML.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.recupera_user_filtros">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">recupera_user_filtros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#recupera_user_filtros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.recupera_user_filtros" title="Permalink to this definition">¶</a></dt>
<dd><p>Usa variável global para guardar filtros personalizados entre posts.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.similar">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">similar</code><span class="sig-paren">(</span><em>_id</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#similar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.similar" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna índice de imagens similares.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.similar_">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">similar_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#similar_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.similar_" title="Permalink to this definition">¶</a></dt>
<dd><p>Chama view de índice de imagens similares por GET.</p>
<p>Recebe _id e offset(página atual).
Para possibilitar rolagem de página.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.stats">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Permite consulta as estatísticas do GridFS e integrações.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.summaryhtml">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">summaryhtml</code><span class="sig-paren">(</span><em>_id=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#summaryhtml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.summaryhtml" title="Permalink to this definition">¶</a></dt>
<dd><p>Tela para exibição de um ‘arquivo’ do GridFS.</p>
<p>Exibe os metadados associados a ele.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.summarytext">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">summarytext</code><span class="sig-paren">(</span><em>_id=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#summarytext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.summarytext" title="Permalink to this definition">¶</a></dt>
<dd><p>Tela para exibição de um ‘arquivo’ do GridFS.</p>
<p>Exibe os metadados associados a ele.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.task_progress">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">task_progress</code><span class="sig-paren">(</span><em>taskid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#task_progress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.task_progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna um json do progresso da celery task.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.upload_bson">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">upload_bson</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#upload_bson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.upload_bson" title="Permalink to this definition">¶</a></dt>
<dd><p>Função simplificada para upload do arquivo de uma extração.</p>
<p>Ver API/Upload BSON</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.views.valida_form_files">
<code class="descclassname">virasana.virasana.views.</code><code class="descname">valida_form_files</code><span class="sig-paren">(</span><em>form</em>, <em>filtro</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/views.html#valida_form_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.views.valida_form_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Lê formulário e adiciona campos ao filtro se necessário.</p>
</dd></dl>

</div>
<div class="section" id="scripts">
<h2><a class="toc-backref" href="#id7">Scripts</a><a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h2>
<p>Este módulo possui scripts utilizados para rodar tarefas de integração e manutenção da base
de dados. Normalmente os scripts utilizam funções do módulo integração.
A integração é parte do pipeline (Ver <a class="reference internal" href="Arquitetura.html#arquitetura"><span class="std std-ref">Arquitetura do Sistema</span></a>), e normalmente será chamada
periodicamente pelos :ref:workers. e :ref:tasks. Muitos scripts são para ajustes quando os
workers falharem e/ou para testes e integrações off-line.</p>
<div class="section" id="module-virasana.virasana.scripts.cargaupdate">
<span id="carga"></span><h3><a class="toc-backref" href="#id8">Carga</a><a class="headerlink" href="#module-virasana.virasana.scripts.cargaupdate" title="Permalink to this headline">¶</a></h3>
<p>Script de linha de comando para integração do Sistema CARGA.</p>
<p>Script de linha de comando para fazer atualização ‘manual’
dos metadados do Sistema CARGA nas imagens.
Faz um loop, a cada “interval” dias, pesquisa o Banco de Dados de
imagens no mês (Ex. interval = 10, pesquisará iniciando dias 1, 10 e 20)</p>
<p>Args:</p>
<blockquote>
<div><p>year: ano a pesquisar</p>
<p>month: mês a pesquisar</p>
<p>interval: intervalo de dias</p>
<p>batch_size: tamanho do lote de atualização/limite de registros da consulta</p>
</div></blockquote>
</div>
<div class="section" id="module-virasana.virasana.scripts.xmlupdate">
<span id="xml"></span><h3><a class="toc-backref" href="#id9">XML</a><a class="headerlink" href="#module-virasana.virasana.scripts.xmlupdate" title="Permalink to this headline">¶</a></h3>
<p>Script de linha de comando para integração do arquivo XML.</p>
<p>Script de linha de comando para fazer atualização ‘manual’
dos metadados do arquivo XML nas imagens.</p>
<p>Args:</p>
<blockquote>
<div><p>year: ano de início da pesquisa</p>
<p>month: mês de início da pesquisa</p>
<p>batch_size: tamanho do lote de atualização/limite de registros da consulta</p>
</div></blockquote>
</div>
<div class="section" id="module-virasana.virasana.scripts.predictionsupdate">
<span id="predicoes-padma"></span><h3><a class="toc-backref" href="#id10">Predições (PADMA)</a><a class="headerlink" href="#module-virasana.virasana.scripts.predictionsupdate" title="Permalink to this headline">¶</a></h3>
<p>Script de linha de comando para integração do Sistema PADMA.</p>
<p>Script de linha de comando para fazer atualização ‘manual’
dos metadados do módulo AJNA-PADMA nas imagens.</p>
<p>Importante: todos os modelos precisam atuar sobre um recorte da imagem
orginal, EXCETO os modelos treinados justamente para detectar este recorte.
Assim, serão filtrados apenas os registros que possuam a chave bbox para
recorte, a menos que o modelo selecionado seja um dos modelos próprios para
detecção do objeto contêiner (lista BBOX_MODELS do integracao.padma).</p>
<p>Args:</p>
<blockquote>
<div><p>modelo: modelos a consultar</p>
<p>t: tamanho do lote de atualização/limite de registros da consulta</p>
<p>q: quantidade de consultas simultâneas (mais rápido até limite do Servidor)</p>
<p>sovazios: selecionar contêineres declarados como vazio somente</p>
<p>force: Tentar mesmo se consulta anterior a este registro falhou.
Obs: em caso de consulta retornar vazia (não detectou resultado),
o script irá gravar um valor em branco [] no campo destino e irá
pular este registro nas próximas atualizações. Habilitar force
processa estes registros novamente.</p>
</div></blockquote>
<dl class="class">
<dt id="virasana.virasana.scripts.predictionsupdate.ImageID">
<em class="property">class </em><code class="descclassname">virasana.virasana.scripts.predictionsupdate.</code><code class="descname">ImageID</code><span class="sig-paren">(</span><em>id</em>, <em>content</em>, <em>predictions</em><span class="sig-paren">)</span><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.ImageID" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="virasana.virasana.scripts.predictionsupdate.ImageID.content">
<code class="descname">content</code><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.ImageID.content" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="virasana.virasana.scripts.predictionsupdate.ImageID.id">
<code class="descname">id</code><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.ImageID.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="virasana.virasana.scripts.predictionsupdate.ImageID.predictions">
<code class="descname">predictions</code><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.ImageID.predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="virasana.virasana.scripts.predictionsupdate.consulta_padma_retorna_image">
<code class="descclassname">virasana.virasana.scripts.predictionsupdate.</code><code class="descname">consulta_padma_retorna_image</code><span class="sig-paren">(</span><em>image: virasana.virasana.scripts.predictionsupdate.ImageID</em>, <em>model: str</em>, <em>campo: str</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/scripts/predictionsupdate.html#consulta_padma_retorna_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.consulta_padma_retorna_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Realiza request no padma. Retorna response e ImageID da consulta.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.scripts.predictionsupdate.cropped_images">
<code class="descclassname">virasana.virasana.scripts.predictionsupdate.</code><code class="descname">cropped_images</code><span class="sig-paren">(</span><em>predictions: dict</em>, <em>image: bytes</em>, <em>_id: int</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/virasana/virasana/scripts/predictionsupdate.html#cropped_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.cropped_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Recorta imagens de acordo com bbox passada.</p>
<p>Para acessar algumas predições, é necessário recortar as imagens antes.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>predictions: dicionário com as predições
image: imagem do contêiner original, em bytes
_id: id do MongoDB se existir. Apenas para reportar erro</dd>
<dt>Returns:</dt>
<dd>lista de imagem(ns) recortada[s]</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.scripts.predictionsupdate.fazconsulta">
<code class="descclassname">virasana.virasana.scripts.predictionsupdate.</code><code class="descname">fazconsulta</code><span class="sig-paren">(</span><em>images: list</em>, <em>model: str</em>, <em>campo: str</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/scripts/predictionsupdate.html#fazconsulta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.fazconsulta" title="Permalink to this definition">¶</a></dt>
<dd><p>Recebe lista de ImageID, monta uma ThreadPool.</p>
<p>Monta ThreadPool do tamanho da lista recebida, chama consulta ao padma.
Recebe retorno de cada Thread e grava no BD.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>images: lista de NamedTuple tipo ImageID
model: nome do modelo
campo: nome do campo a gravar no BD</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.scripts.predictionsupdate.get_images">
<code class="descclassname">virasana.virasana.scripts.predictionsupdate.</code><code class="descname">get_images</code><span class="sig-paren">(</span><em>model: str</em>, <em>_id: bson.objectid.ObjectId</em>, <em>image: bytes</em>, <em>predictions: dict</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/virasana/virasana/scripts/predictionsupdate.html#get_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.get_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna ImagemID.</p>
<p>Se model for BBOX, simplesmente anexa imagem original.
Se model for outro tipo, recorta BBOX antes utilizando predictions BBOX
já vinculadas à imagem _id e anexa uma ou duas imagens resultantes.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.scripts.predictionsupdate.monta_filtro">
<code class="descclassname">virasana.virasana.scripts.predictionsupdate.</code><code class="descname">monta_filtro</code><span class="sig-paren">(</span><em>model: str</em>, <em>sovazios: bool</em>, <em>update: str</em>, <em>tamanho: int</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/virasana/virasana/scripts/predictionsupdate.html#monta_filtro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.monta_filtro" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna filtro para MongoDB.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.scripts.predictionsupdate.mostra_tempo_final">
<code class="descclassname">virasana.virasana.scripts.predictionsupdate.</code><code class="descname">mostra_tempo_final</code><span class="sig-paren">(</span><em>s_inicial</em>, <em>registros_vazios</em>, <em>registros_processados</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/scripts/predictionsupdate.html#mostra_tempo_final"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.scripts.predictionsupdate.mostra_tempo_final" title="Permalink to this definition">¶</a></dt>
<dd><p>Exibe mensagem de tempo decorrido.</p>
</dd></dl>

</div>
</div>
<div class="section" id="integracao">
<h2><a class="toc-backref" href="#id11">Integracao</a><a class="headerlink" href="#integracao" title="Permalink to this headline">¶</a></h2>
<p>Neste módulo ficam os diversos scripts para integração entre as imagens e
as fontes de dados. Cada fonte de dados deve ter um módulo definido.</p>
<div class="section" id="module-virasana.virasana.integracao">
<span id="init"></span><h3><a class="toc-backref" href="#id12">__init__</a><a class="headerlink" href="#module-virasana.virasana.integracao" title="Permalink to this headline">¶</a></h3>
<p>Funções padrão para exploração do GridFS.</p>
<p>Como repositório de informações do Banco de Dados, facilitando a documentação
e o desenvolvimento.</p>
<p>Assim, neste arquivo e nos demais deste módulo pode-se conferir como está
sendo estruturado o Banco de Dados final, que nada mais é do que a integração
de diversas fontes de dados, cada uma com seu módulo neste pacote. Pode-se
também conferir os campos chave para os quais estão sendo criados índices,
conferir as “chaves primária e estrangeira”, as datas, categorias, etc.</p>
<p>Além disso, podem ser criadas e mantidas aqui funções que dêem estatíticas
sobre a base para informar os usuários.</p>
<dl class="function">
<dt id="virasana.virasana.integracao.create_indexes">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">create_indexes</code><span class="sig-paren">(</span><em>db</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#create_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.create_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Cria índices necessários no GridFS.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.datas_bases">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">datas_bases</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#datas_bases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.datas_bases" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna nomes dos campos que possuem as datas de referência.</p>
<p>Para cada integração, consulta se há data de referência e retorna</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.dict_to_html">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">dict_to_html</code><span class="sig-paren">(</span><em>adict: dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#dict_to_html"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.dict_to_html" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna HTML.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.dict_to_text">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">dict_to_text</code><span class="sig-paren">(</span><em>adict: dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#dict_to_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.dict_to_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna keyn [valuen].</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.gridfs_count">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">gridfs_count</code><span class="sig-paren">(</span><em>db</em>, <em>filtro={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#gridfs_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.gridfs_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Aplica filtro, retorna contagem.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.peso_container_balanca">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">peso_container_balanca</code><span class="sig-paren">(</span><em>db</em>, <em>numero: list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#peso_container_balanca"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.peso_container_balanca" title="Permalink to this definition">¶</a></dt>
<dd><p>Procedimento necessário para apurar o peso pesado do contêiner.</p>
<p>Procedimento necessário para apurar o peso do contêiner tendo em vista
as informações importadas dos sistemas de pesagem dos Recintos Aduaneiros.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>db: conexão ao MongoDB GridFS
numero: lista com os números de</dd>
<dt>Returns:</dt>
<dd>dict[numero] = peso</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.peso_container_documento">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">peso_container_documento</code><span class="sig-paren">(</span><em>db</em>, <em>numeros: list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#peso_container_documento"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.peso_container_documento" title="Permalink to this definition">¶</a></dt>
<dd><p>Procedimento necessário para apurar o peso do contêiner.</p>
<p>Procedimento necessário para apurar o peso do contêiner tendo em vista
as informações importadas do CARGA.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>db: conexão ao MongoDB GridFS
numero: lista com os números de contêiner</dd>
<dt>Returns:</dt>
<dd>dict[numero] = peso</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.plot_bar_plotly">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">plot_bar_plotly</code><span class="sig-paren">(</span><em>values</em>, <em>labels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#plot_bar_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.plot_bar_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Gera gráfico de barras.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.plot_pie_plotly">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">plot_pie_plotly</code><span class="sig-paren">(</span><em>values</em>, <em>labels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#plot_pie_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.plot_pie_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Gera gráfico de terminais.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.stats_por">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">stats_por</code><span class="sig-paren">(</span><em>db</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#stats_por"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.stats_por" title="Permalink to this definition">¶</a></dt>
<dd><p>soon.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.stats_resumo_imagens">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">stats_resumo_imagens</code><span class="sig-paren">(</span><em>db</em>, <em>datainicio=None</em>, <em>datafim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#stats_resumo_imagens"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.stats_resumo_imagens" title="Permalink to this definition">¶</a></dt>
<dd><p>Números gerais do Banco de Dados e suas integrações.</p>
<p>Estatísticas gerais sobre as imagens</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.summary">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">summary</code><span class="sig-paren">(</span><em>grid_data=None</em>, <em>registro=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Selecionar campos mais importantes para exibição.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>grid_data: Registro GridData do Gridfs.get
registro: registro (dict) lido de cursor do MongoDB</dd>
<dt>Returns:</dt>
<dd>dict com descrição e valor de campos. (str: str)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.tag">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">tag</code><span class="sig-paren">(</span><em>word: str</em>, <em>tags: list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#tag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.tag" title="Permalink to this definition">¶</a></dt>
<dd><p>Coloca tags em torno de word.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.volume_container">
<code class="descclassname">virasana.virasana.integracao.</code><code class="descname">volume_container</code><span class="sig-paren">(</span><em>db</em>, <em>numeros: list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao.html#volume_container"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.volume_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Procedimento necessário para apurar o volume do contêiner.</p>
<p>Procedimento necessário para apurar o volume do contêiner tendo em vista
as informações importadas do CARGA.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>db: conexão ao MongoDB GridFS
numero: lista com os números de contêiner</dd>
<dt>Returns:</dt>
<dd>dict[numero] = volume</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id13">Carga</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-virasana.virasana.integracao.carga"></span><p>Funçãoes para importar os dados da base CARGA do Bhadrasana.</p>
<dl class="function">
<dt id="virasana.virasana.integracao.carga.busca_atracacao_data">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">busca_atracacao_data</code><span class="sig-paren">(</span><em>atracacoes: list</em>, <em>scan_datetime: datetime.datetime</em>, <em>days</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#busca_atracacao_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.busca_atracacao_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Pega da lista de atracações a atracação com a data mais próxima.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">atracacoes: lista de dict contendo os registros das atracacoes</p>
<p>scan_datetime: data de partida</p>
<p>data: data buscada</p>
<p class="last">days: “threshold”  máxima diferença entre as datas</p>
</dd>
<dt>Returns:</dt>
<dd>Índice da atracação, None se atracação não existe ou não está no
intervalo threshold</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.busca_info_container">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">busca_info_container</code><span class="sig-paren">(</span><em>db</em>, <em>numero: str</em>, <em>data_escaneamento: datetime.datetime</em>, <em>days=5</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#busca_info_container"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.busca_info_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Busca heurística na base CARGA MongoDB de dados sobre o Contêiner.</p>
<p>A busca é baseada na data de escaneamento. O parâmetro dias é um
“threshold” (diferença aceita entre a data de atracação e escaneamento),
por padrão, é de -5 dias na importação e +10 dias na importação.</p>
<p>Dentro destes 5 dias, será considerado o CE/Manifesto/Escala com menor
diferença de data como o pertencente a este contêiner.
Note-se que o resultado não é garantido, podendo trazer um CE incorreto.</p>
<p>As informações são imperfeitas e não há como garantir trazer o CE correto,
mas espera-se um acerto próximo de 100%, já que a frequência de cada
contêiner em cada porto tem um intervalo típico de semanas e até meses,
sendo extremamente incomum um contêiner ter duas “viagens” no mesmo
porto em menos de 5 dias +/-.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">numero: número completo do contêiner</p>
<p>data_escaneamento: data e hora do escaneamento, conforme
arquivo XML original do escâner</p>
<p class="last">days: número de dias a aceitar de diferença</p>
</dd>
<dt>Returns:</dt>
<dd>json_dict: Dicionário com campos e valores de informações da base
CARGA VAZIO se não encontrar nada dentro do threshold
(Caso não encontre atracacao para o Contêiner no prazo, o dado ?ainda?
não existe ou não foi importado ou há um erro)!</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.busca_vazios">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">busca_vazios</code><span class="sig-paren">(</span><em>db</em>, <em>numero: str</em>, <em>data_escaneamento</em>, <em>days</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#busca_vazios"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.busca_vazios" title="Permalink to this definition">¶</a></dt>
<dd><p>Heurística para buscar manifesto de vazio.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>db: conexão com MongoDB
numero: número do contâiner
dataescaneamento: data de busca</dd>
<dt>Returns:</dt>
<dd>dict com informações do CARGA, se manifesto de vazio encontrado</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.converte_datahora_atracacao">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">converte_datahora_atracacao</code><span class="sig-paren">(</span><em>atracacao: dict</em><span class="sig-paren">)</span> &#x2192; datetime.datetime<a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#converte_datahora_atracacao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.converte_datahora_atracacao" title="Permalink to this definition">¶</a></dt>
<dd><p>Tansforma data e hora de atracação em objeto datetime.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>atracacao: dict contendo chaves dataatracacao e horaaatracacao</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.create_indexes">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">create_indexes</code><span class="sig-paren">(</span><em>db</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#create_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.create_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Utilitário. Cria índices relacionados à integração.</p>
<p>São criados índices para desempenho nas consultas.
Alguns índices únicos também são criados, estes para evitar importação
duplicada do mesmo registro.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.dados_carga_grava_fsfiles">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">dados_carga_grava_fsfiles</code><span class="sig-paren">(</span><em>db</em>, <em>batch_size=1000</em>, <em>data_inicio=datetime.datetime(1900</em>, <em>1</em>, <em>1</em>, <em>0</em>, <em>0)</em>, <em>days=5</em>, <em>update=True</em>, <em>force_update=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#dados_carga_grava_fsfiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.dados_carga_grava_fsfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Busca por registros no GridFS sem info do CARGA.</p>
<p>Busca por registros no fs.files (GridFS - imagens) que não tenham metadata
importada do sistema CARGA. Itera estes registros, consultando a
busca_info_container para ver se retorna informações do CARGA. Encontrando
estas informações, grava no campo metadata.carga do fs.files</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">db: conexão com o banco de dados selecionado.</p>
<p>batch_size: número de registros a consultar/atualizar por chamada</p>
<p>data_inicio: filtra por data de escaneamento maior que a informada</p>
<p>days: número de dias a aceitar de diferença</p>
<p>update: Caso seja setado como False, apenas faz consulta, sem
atualizar metadata da collection fs.files</p>
<p class="last">force_update: Marcar “NA” - not available se não encontrar dados do
CARGA. Usar com consciência/cuidado.</p>
</dd>
<dt>Returns:</dt>
<dd>Número de registros encontrados</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.get_escalas">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">get_escalas</code><span class="sig-paren">(</span><em>db</em>, <em>conhecimentos_set: set</em>, <em>scan_datetime: datetime.datetime</em>, <em>days: int</em>, <em>exportacao=False</em><span class="sig-paren">)</span> &#x2192; typing.Tuple[[list, list], int]<a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#get_escalas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.get_escalas" title="Permalink to this definition">¶</a></dt>
<dd><p>Dada uma lista de conhecimentos, retorna a lista de escalas.</p>
<p>Retorna a lista de escalas vinculadas, com datadeatracao entre
scan_datetime e scan_datetime + days</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">conhecimentos: lista de dict contendo os registros das atracacoes</p>
<p>scan_datetime: data de partida</p>
<p class="last">days: “threshold”  máxima diferença entre as datas</p>
</dd>
<dt>Returns:</dt>
<dd>(manifestos, escalas)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.mongo_find_in">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">mongo_find_in</code><span class="sig-paren">(</span><em>db</em>, <em>collection: str</em>, <em>field: str</em>, <em>in_set</em>, <em>set_field: str = None</em>, <em>filtros: dict = None</em><span class="sig-paren">)</span> &#x2192; typing.Tuple[list, set]<a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#mongo_find_in"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.mongo_find_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Realiza um find $in in_set no db.collection.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">db: conexão ao MongoDB com banco de dados selecionado “setted”</p>
<p>collection: nome da coleção mongo para aplicar a “query”</p>
<p>field: campo para aplicar a “filter by”</p>
<p>in_set: lista ou conjunto de valores a passar para o operador “$in”</p>
<p>set_field: campo para obter valores únicos (opcional)</p>
<p class="last">filtros: filtros adicionais a aplicar</p>
</dd>
<dt>Returns:</dt>
<dd>Dicionário de resultados formatado key:value(Somente campos não nulos)
Conjuntos de set_field</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.monta_info_cheio">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">monta_info_cheio</code><span class="sig-paren">(</span><em>db</em>, <em>index_atracacao</em>, <em>atracacoes</em>, <em>escalas</em>, <em>manifestosc</em>, <em>conteineres</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#monta_info_cheio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.monta_info_cheio" title="Permalink to this definition">¶</a></dt>
<dd><p>Apenas faz montagem do dicionário se encontrado CE.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.nlinhas_zip_dir">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">nlinhas_zip_dir</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#nlinhas_zip_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.nlinhas_zip_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Retorna o número de linhas de um conjunto de extrações.</p>
<p>Dado um diretório(path) procura extrações do Siscomex CARGA, abre seus zip,
abre o arquivo de cada zip e conta as linhas.</p>
<p>Para AUDITORIA após um arquivamento da base CARGA confirmar se número de
registros no arquivo (MongoDB) é igual a número original de linhas.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path: caminho do(s) arquivo(s) de extração(ões)</dd>
<dt>Returns:</dt>
<dd>Número de conhecimentos</dd>
<dt>Comparar com:</dt>
<dd><dl class="first last docutils">
<dt>db[‘fs.files’].find({‘metadata.carga.atracacao.dataatracacao’:</dt>
<dd>{$gt: date, $lt: date}}).count()</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.carga.summary">
<code class="descclassname">virasana.virasana.integracao.carga.</code><code class="descname">summary</code><span class="sig-paren">(</span><em>grid_data=None</em>, <em>registro=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao/carga.html#summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.carga.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Selecionar campos mais importantes para exibição.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>grid_data: Registro GridData do Gridfs.get
registro: registro (dict) lido de cursor do MongoDB</dd>
<dt>Returns:</dt>
<dd>dict com descrição e valor de campos. (str: str)</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="workers">
<span id="id2"></span><h3><a class="toc-backref" href="#id14">XML</a><a class="headerlink" href="#workers" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-virasana.virasana.integracao.xmli"></span><p>Funções para leitura e tratamento arquivos XML criados pelos escâneres.</p>
<dl class="function">
<dt id="virasana.virasana.integracao.xmli.create_indexes">
<code class="descclassname">virasana.virasana.integracao.xmli.</code><code class="descname">create_indexes</code><span class="sig-paren">(</span><em>db</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao/xmli.html#create_indexes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.xmli.create_indexes" title="Permalink to this definition">¶</a></dt>
<dd><p>Utilitário. Cria índices relacionados à integração.</p>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.xmli.dados_xml_grava_fsfiles">
<code class="descclassname">virasana.virasana.integracao.xmli.</code><code class="descname">dados_xml_grava_fsfiles</code><span class="sig-paren">(</span><em>db</em>, <em>batch_size=5000</em>, <em>data_inicio=datetime.datetime(1900</em>, <em>1</em>, <em>1</em>, <em>0</em>, <em>0)</em>, <em>update=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/integracao/xmli.html#dados_xml_grava_fsfiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.xmli.dados_xml_grava_fsfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Busca por registros no GridFS sem info do XML.</p>
<p>Busca por registros no fs.files (GridFS - imagens) que não tenham metadata
importada do arquivo XML. Itera estes registros, consultando a
xml_todict para ver se retorna informações do XML. Encontrando
estas informações, grava no campo metadata.xml do fs.files</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">db: connection to mongo with database setted</p>
<p>batch_size: número de registros a consultar/atualizar por chamada</p>
<p>data_inicio: filtra por data de escaneamento maior que a informada</p>
<dl class="last docutils">
<dt>update: Caso seja setado como False, apenas faz consulta, sem</dt>
<dd>atualizar metadata da collection fs.files</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>Número de registros encontrados</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.integracao.xmli.xml_todict">
<code class="descclassname">virasana.virasana.integracao.xmli.</code><code class="descname">xml_todict</code><span class="sig-paren">(</span><em>xml</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/virasana/virasana/integracao/xmli.html#xml_todict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.integracao.xmli.xml_todict" title="Permalink to this definition">¶</a></dt>
<dd><p>Recebe um XML string stream, retorna um dict com campos do XML.</p>
<p>Lê o XML que acompanha as imagens no formato do Escâner da ALFSTS,
retorna dict(s) com os dados considerados mais importantes e resumos
(ex.: número do(s) cc(s), datas, etc) - configurar na var. fields</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>xml: string de texto na memória com o conteúdo do arquivo XML</dd>
<dt>Returns:</dt>
<dd>Dicionário com as tags selecionadas. A tag container é uma lista
(imagens de cc de 20’ podem conter dois contêineres escaneados)</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id15">Workers</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-virasana.virasana.workers.dir_monitor">
<span id="dir-monitor"></span><h3><a class="toc-backref" href="#id16">dir_monitor</a><a class="headerlink" href="#module-virasana.virasana.workers.dir_monitor" title="Permalink to this headline">¶</a></h3>
<p>Monitora um diretório e envia arquivos BSON nele para o virasana.</p>
<p>USAGE
python dir_monitor.py</p>
<p>A cada intervalo de tempo configurado, lista os arquivos do diretório BSON_DIR
Se houverem arquivos, envia via POST para o endereco VIRASANA_URL</p>
<p>Pode ser importado e rodado em uma tarefa periódica (celery, cron, etc)</p>
<dl class="function">
<dt id="virasana.virasana.workers.dir_monitor.despacha">
<code class="descclassname">virasana.virasana.workers.dir_monitor.</code><code class="descname">despacha</code><span class="sig-paren">(</span><em>filename</em>, <em>target='http://localhost:5001/api/uploadbson'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/workers/dir_monitor.html#despacha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.workers.dir_monitor.despacha" title="Permalink to this definition">¶</a></dt>
<dd><p>Envia por HTTP POST o arquivo especificado.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">file: caminho completo do arquivo a enviar</p>
<p class="last">target: URL do Servidor e API destino</p>
</dd>
<dt>Returns:</dt>
<dd>(Erro, Resposta)
(True, None) se tudo correr bem
(False, response) se ocorrer erro</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.workers.dir_monitor.despacha_dir">
<code class="descclassname">virasana.virasana.workers.dir_monitor.</code><code class="descname">despacha_dir</code><span class="sig-paren">(</span><em>dir='/home/ivan/pybr/ajna_docs/docs/../virasana/virasana/workers/../../../../files/BSON'</em>, <em>target='http://localhost:5001/api/uploadbson'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/workers/dir_monitor.html#despacha_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.workers.dir_monitor.despacha_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Envia por HTTP POST todos os arquivos do diretório.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">dir: caminho completo do diretório a pesquisar</p>
<p class="last">target: URL do Servidor e API destino</p>
</dd>
<dt>Returns:</dt>
<dd>Lista de erros</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virasana.virasana.workers.dir_monitor.espera_resposta">
<code class="descclassname">virasana.virasana.workers.dir_monitor.</code><code class="descname">espera_resposta</code><span class="sig-paren">(</span><em>api_url</em>, <em>bson_file</em>, <em>sleep_time=10</em>, <em>timeout=180</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/virasana/virasana/workers/dir_monitor.html#espera_resposta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.workers.dir_monitor.espera_resposta" title="Permalink to this definition">¶</a></dt>
<dd><p>Espera resposta da task.</p>
<p>Espera resposta da task que efetivamente carregará o arquivo no
Banco de Dados do Servidor.
Recebendo uma resposta positiva, exclui arquivo enviado do disco.
Recebendo uma resposta negativa, grava no logger.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">api_url: endereço para acesso aos dados da task</p>
<p>bson_file: caminho completo do arquivo original que foi enviado</p>
<p>sleep_time: tempo entre requisições ao Servidor em segundos</p>
<p class="last">timeout: tempo total para aguardar resposta, em segundos</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="tasks">
<span id="id4"></span><h3><a class="toc-backref" href="#id17">Tasks</a><a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-virasana.virasana.workers.tasks"></span><p>Definição dos códigos que serão rodados pelo Celery.</p>
<p>Background tasks do sistema AJNA-virasana
Gerenciados por celery.sh
Aqui ficam as que rodam tarefas custosas/demoradas em background.</p>
<dl class="function">
<dt id="virasana.virasana.workers.tasks.trata_bson">
<code class="descclassname">virasana.virasana.workers.tasks.</code><code class="descname">trata_bson</code><span class="sig-paren">(</span><em>bson_file: str</em>, <em>db: pymongo.mongo_client.MongoClient</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/virasana/virasana/workers/tasks.html#trata_bson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#virasana.virasana.workers.tasks.trata_bson" title="Permalink to this definition">¶</a></dt>
<dd><p>Recebe o nome de um arquivo bson e o insere no MongoDB.</p>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="padma.html" class="btn btn-neutral float-right" title="PADMA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="bhadrasana.html" class="btn btn-neutral" title="BHADRASANA" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, RFB.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1a',
            LANGUAGE:'pt-BR',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>